/*
 Copyright (c) Microsoft Corporation.  All rights reserved.
 This code is licensed by Microsoft Corporation under the terms
 of the MICROSOFT REACTIVE EXTENSIONS FOR JAVASCRIPT AND .NET LIBRARIES License.
 See http://go.microsoft.com/fwlink/?LinkID=220762.
*/
(function(s,t){var d;d="undefined"!==typeof exports?require("./rx.min.js"):s.Rx;var h=d.Observable,l=h.prototype,n=h.createWithDisposable,u=h.concat,q=h.defer,m=h.empty,v=d.Disposable.empty,w=d.Internals.BinaryObserver,o=d.CompositeDisposable,x=d.SerialDisposable,p=d.SingleAssignmentDisposable,y=d.Internals.Enumerator.create,r=d.Internals.Enumerable,z=r.forEach,A=d.Scheduler.Immediate,B=Array.prototype.slice,C=function(b,c,a){return n(function(e){var g=new p,f=new p,e=a(e,g,f);g.disposable(b.materialize().select(function(a){return{switchValue:function(c){return c(a)}}}).subscribe(e));
f.disposable(c.materialize().select(function(a){return{switchValue:function(c,b){return b(a)}}}).subscribe(e));return new o(g,f)})},D=function(b,c){return new r(function(){var a;return y(function(){return b()?(a=c,!0):!1},function(){return a})})};h.ifThen=function(b,c,a){return q(function(){a||(a=m());a.now&&(a=m(a));return b()?c:a})};h.forIn=function(b,c){return z(b,c).concat()};var E=h.whileDo=function(b,c){return D(b,c).concat()};l.doWhile=function(b){return u([this,E(b,this)])};h.switchCase=function(b,
c,a){return q(function(){a||(a=m());a.now&&(a=m(a));var e=c[b()];return e!==t?e:a})};l.expand=function(b,c){c||(c=A);var a=this;return n(function(e){var g=[],f=new x,d=new o(f),j=0,k=!1,i;i=function(){var a=!1;0<g.length&&(a=!k,k=!0);a&&f.setDisposable(c.scheduleRecursive(function(a){var c;if(0<g.length){c=g.shift();var f=new p;d.add(f);f.setDisposable(c.subscribe(function(a){e.onNext(a);var c=null;try{c=b(a)}catch(f){e.onError(f)}g.push(c);j++;i()},function(a){e.onError(a)},function(){d.remove(f);
j--;if(0===j)e.onCompleted()}));a()}else k=!1}))};g.push(a);j++;i();return d})};h.forkJoin=function(){var b=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:B.call(arguments);return n(function(c){var a=b.length;if(0===a)return c.onCompleted(),v;for(var e=new o,g=!1,f=Array(a),d=Array(a),j=Array(a),k=0;k<a;k++)(function(i){e.add(b[i].subscribe(function(a){g||(f[i]=!0,j[i]=a)},function(a){g=!0;c.onError(a);e.dispose()},function(){if(!g){if(f[i]){d[i]=!0;for(var b=0;b<a;b++)if(!d[b])return;
g=!0;c.onNext(j)}c.onCompleted()}}))})(k);return e})};l.forkJoin=function(b,c){return C(this,b,function(a,b,d){var f=!1,h=!1,j=!1,k=!1,i,l;return new w(function(b){switch(b.kind){case "N":j=!0;i=b.value;break;case "E":d.dispose();a.onError(b.exception);break;case "C":if(f=!0,h){if(j&&k){var e;try{e=c(i,l)}catch(m){a.onError(m);break}a.onNext(e)}a.onCompleted()}}},function(d){switch(d.kind){case "N":k=!0;l=d.value;break;case "E":b.dispose();a.onError(d.exception);break;case "C":if(h=!0,f){if(j&&k){var g;
try{g=c(i,l)}catch(m){a.onError(m);break}a.onNext(g)}a.onCompleted()}}})})};l.letBind=function(b){return b(this)}})(this);
